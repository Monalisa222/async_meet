<div class="mb-6">
  <%= link_to "<- Back to Meetings",
        meetings_path, data: { turbo: false },
        class: "text-sm text-gray-600 hover:text-gray-900" %>
</div>

<div class="bg-white p-6 rounded-xl shadow-sm">
  <div class="flex items-center justify-between mb-4">
      <h1 class="text-2xl font-semibold text-gray-900">
        <%= @meeting.title %>
      </h1>

      <% if current_membership&.owner? %>
        <%= link_to "Edit",
              edit_meeting_path(@meeting),
              class: "ml-4 text-sm text-blue-600 hover:text-blue-800 font-medium" %>
      <% end %>
    </div>

  <!-- Status Badge -->
  <span class="inline-block px-3 py-1 text-sm font-medium rounded-full
             <%= case @meeting.status
                 when 'scheduled' then 'bg-green-100 text-green-800'
                 when 'completed' then 'bg-gray-100 text-gray-800'
                 when 'cancelled' then 'bg-red-100 text-red-800'
                  else 'bg-gray-100 text-gray-800'
                  end %>">
    <%= @meeting.status.humanize %>
  </span>

  <% if @meeting.description.present? %>
    <p class="text-gray-700 mt-4">
      <%= @meeting.description %>
    </p>
  <% end %>

  <div class="mt-4 text-sm text-gray-500 space-y-1">
    <p>
      <span class="font-medium text-gray-900">Scheduled for:</span>
      <%= @meeting.scheduled_at.strftime("%B %d, %Y at %I:%M %p") %>
    </p>

    <% if @meeting.duration_minutes.present? %>
      <p>
        <span class="font-medium text-gray-900">Duration:</span>
        <%= @meeting.duration_minutes %> minutes
      </p>
    <% end %>

   <% if @meeting.meeting_url.present? %>
      <p>
        <span class="font-medium text-gray-900">Meeting URL:</span>
        <a href="<%= @meeting.meeting_url %>" target="_blank" class="text-blue-600 hover:underline">
          Join Meeting
        </a>
      </p>
    <% end %>

    <!-- Audio File -->
    <% if @meeting.audio_file.attached? %>
      <div class="mt-6 bg-white p-4 rounded-lg shadow-sm">
        <h3 class="text-lg font-medium text-gray-900 mb-2">Meeting Audio</h3>
        <audio controls class="w-full">
          <source src="<%= url_for(@meeting.audio_file) %>" type="<%= @meeting.audio_file.content_type %>">
          Your browser does not support the audio element.
        </audio>

        <% unless @meeting.ai_processed? %>
          <p class="text-sm text-gray-500 mt-2">Processing audio with AI... Please check back later.</p>
        <% end %>
      </div>
    <% end %>

    <% if @meeting.transcript.present? %>
      <div class="mt-6 bg-gray-50 p-4 rounded-lg shadow-sm">
        <h3 class="text-lg font-medium text-gray-900 mb-2">AI Transcript</h3>
        <p class="text-gray-700 whitespace-pre-wrap"><%= @meeting.transcript %></p>
        <% if @meeting.ai_summary.present? %>
          <div class="mt-4 bg-white p-4 rounded-lg shadow-sm">
            <h3 class="text-lg font-medium text-gray-900 mb-2">AI Summary</h3>
            <p class="text-gray-700 whitespace-pre-wrap"><%= @meeting.ai_summary %></p>
          </div>
        <% end %>
      </div>
    <% end %>

    <p>
      <span class="font-medium text-gray-900">Created by:</span>
      <%= @meeting.creator.email %>
    </p>
  </div>
</div>

<!-- Tasks Section Placeholder -->
<div class="mt-8 mb-4 flex items-center justify-between">
  <h2 class="text-xl font-semibold text-gray-900">Tasks</h2>
</div>

<!-- Task Form Placeholder -->
<div class="mb-6">
  <%= render "tasks/form", meeting: @meeting, task: Task.new %>
</div>

<!-- Tasks List Placeholder -->
<% if @meeting.tasks.any? %>
  <div class="space-y-4">
    <%= render @meeting.tasks %>
  </div>
<% else %>
  <p class="text-gray-700">No tasks yet. Add one above!</p>
<% end %>
